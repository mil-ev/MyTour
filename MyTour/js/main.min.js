$(document).on("ready",function(){function n(){$(".datepicker-here").datepicker({minDate:new Date,toggleSelected:!1})}function r(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e,o):alert("Geolocation API не поддерживается в вашем браузере")}function e(n){var t=n.coords.latitude,r=n.coords.longitude,e=new google.maps.LatLng(t,r),o=new google.maps.Geocoder;o.geocode({latLng:e},function(n,t){var r=n[2].formatted_address;$(".selection-city").val(r)})}function o(n){var t=n.code;1==t?alert("Ваш город не определен. Вы решили не предоставлять данные о своем местоположении."):2==t?alert("Проблемы с сетью или нельзя связаться со службой определения местоположения по каким-либо другим причинам."):3==t?alert("He удалось определить местоположение в течение установленного времени."):alert("Неустановленная ошибка.")}n(),$(".selections").on("click",".add-selection",function(t){t.preventDefault(),$.get("new-selection.html",function(t){var o,e=$(".tab-pane"),i=1;if(e.length){var a=e.last().attr("id");i=parseInt(a.replace(/\D+/g,""))+1,o="selection-"+i}else o="selection-"+i;var c=$(t).attr("id",o);$(".tab-content").append(c);var l="autocomplete-cities-"+i;c.find(".selection-city").attr("id",l);new google.maps.places.Autocomplete(document.getElementById(l),{language:"ru",componentRestrictions:{country:"ru"},types:["(cities)"]});r();var p="ПОДБОРКА №"+i;c.find(".selection-name").val(p),$(".nav-tabs li").last().before('<li role="presentation"><a href="#'+o+'" aria-controls="'+o+'" role="tab" data-toggle="tab">'+p+"</a></li>"),n();var u=c.find(".how-many-night"),s=u.find(".from-date").val(),v=u.find(".to-date").val();u.prev(".inp-how-many-night").val(s+" ― "+v+" ночей");var m=c.find(".how-many-people"),y=m.find(".adult").val(),d=m.find(".children").val();m.prev(".inp-how-many-people").val(y+" взрослых, "+d+" детей");var f=c.find(".how-many-money"),h=f.find(".from-rub").val(),b=f.find(".to-rub").val();f.prev(".inp-how-many-money").val(h+" Р ― "+b+" Р");var w=c.find(".how-many-rating"),k=w.find(".rating-select").val();w.prev(".block-rating").children(".inp-how-many-rating").val(k);var C=c.find(".type-food"),x=C.find(".select-type-food").val();C.prev(".inp-type-food").val(x);var D=c.find(".location-hotel"),I=D.find(".select-location-hotel").val();D.prev(".inp-location-hotel").val(I),$(".tab-pane").removeClass("active"),$(".tab-pane").last().addClass("active"),$(".nav-tabs li").removeClass("active"),$(".nav-tabs li").last().prev().addClass("active")})});new google.maps.places.Autocomplete(document.getElementById("autocomplete-cities-1"),{language:"ru",componentRestrictions:{country:"ru"},types:["(cities)"]});r(),$(".selections").on("click",".city-reset",function(n){n.preventDefault(),$(n.target).prev(".selection-city").val("")}),$(".selections").on("submit",".tab-pane form",function(n){n.preventDefault();var t=$(this),r=t.serialize(),e=t.find(".selection-name").val(),o="#"+t.parent(".tab-pane").attr("id"),i=t.closest(".selections").find(".nav-tabs a");i.each(function(){var n=$(this);n.attr("href")===o&&n.text(e)}),$.ajax({type:"POST",url:"form.php",data:r,success:function(n){t.parent(".tab-pane").append(n)},error:function(n,t,r){alert("Возникла ошибка при отправке формы. Попробуйте еще раз.")}})}),$(".selections").on("click",".country button",function(n){n.preventDefault(),$(this).closest(".country li").remove()}),$(document).on("click",function(n){var t=$(".button-ul-region"),r=t.find(".add-ul-button");t.is(n.target)||0!==t.has(n.target).length||r.hide();var e=$(".button-ul-country"),o=e.find(".add-ul-button");e.is(n.target)||0!==e.has(n.target).length||o.hide();var i=$(".pop-up-filter"),a=$(".toggle-popup");i.is(n.target)||0!==i.has(n.target).length||a.is(n.target)||i.hide()}),$(".selections").on("click",".add-region-country",function(n){n.preventDefault();var t=$(this);t.hasClass("button-disabled")||(t.next(".add-ul-button").slideToggle(100),$(".add-region-country").not(n.target).next(".add-ul-button").hide())}),$(".selections").on("click",".wrap-ul-add label",function(n){var t=$(".wrap-ul-add input");t.each(function(){input=$(this),input.prop("checked")?input.parent().addClass("icon-ok"):input.parent().removeClass("icon-ok")})});var i={region1:[["img/фл-индонезия.png","r1 - country1"],["img/фл-вьетнам.png","r1 - country2"],["img/фл-тайланд.png","r1 - country3"],["img/фл-индонезия.png","r1 - country4"],["img/фл-вьетнам.png","r1 - country5"],["img/фл-тайланд.png","r1 - country6"],["img/фл-индонезия.png","r1 - country7"],["img/фл-тайланд.png","r1 - country8"],["img/фл-вьетнам.png","r1 - country9"],["img/фл-индонезия.png","r1 - country10"]],region2:[["img/фл-индонезия.png","r2 - country1"],["img/фл-вьетнам.png","r2 - country2"],["img/фл-тайланд.png","r2 - country3"],["img/фл-индонезия.png","r2 - country4"],["img/фл-вьетнам.png","r2 - country5"],["img/фл-тайланд.png","r2 - country6"],["img/фл-индонезия.png","r2 - country7"],["img/фл-тайланд.png","r2 - country8"],["img/фл-вьетнам.png","r2 - country9"],["img/фл-индонезия.png","r2 - country10"]],region3:[["img/фл-индонезия.png","r3 - country1"],["img/фл-вьетнам.png","r3 - country2"],["img/фл-тайланд.png","r3 - country3"],["img/фл-индонезия.png","r3 - country4"],["img/фл-вьетнам.png","r3 - country5"],["img/фл-тайланд.png","r3 - country6"],["img/фл-индонезия.png","r3 - country7"],["img/фл-тайланд.png","r3 - country8"],["img/фл-вьетнам.png","r3 - country9"],["img/фл-индонезия.png","r3 - country10"]],region4:[["img/фл-индонезия.png","r4 - country1"],["img/фл-вьетнам.png","r4 - country2"],["img/фл-тайланд.png","r4 - country3"],["img/фл-индонезия.png","r4 - country4"],["img/фл-вьетнам.png","r4 - country5"],["img/фл-тайланд.png","r4 - country6"],["img/фл-индонезия.png","r4 - country7"],["img/фл-тайланд.png","r4 - country8"],["img/фл-вьетнам.png","r4 - country9"],["img/фл-индонезия.png","r4 - country10"]],region5:[["img/фл-индонезия.png","r5 - country1"],["img/фл-вьетнам.png","r5 - country2"],["img/фл-тайланд.png","r5 - country3"],["img/фл-индонезия.png","r5 - country4"],["img/фл-вьетнам.png","r5 - country5"],["img/фл-тайланд.png","r5 - country6"],["img/фл-индонезия.png","r5 - country7"],["img/фл-тайланд.png","r5 - country8"],["img/фл-вьетнам.png","r5 - country9"],["img/фл-индонезия.png","r5 - country10"]],region6:[["img/фл-индонезия.png","r6 - country1"],["img/фл-вьетнам.png","r6 - country2"],["img/фл-тайланд.png","r6 - country3"],["img/фл-индонезия.png","r6 - country4"],["img/фл-вьетнам.png","r6 - country5"],["img/фл-тайланд.png","r6 - country6"],["img/фл-индонезия.png","r6 - country7"],["img/фл-тайланд.png","r6 - country8"],["img/фл-вьетнам.png","r6 - country9"],["img/фл-индонезия.png","r6 - country10"]],region7:[["img/фл-индонезия.png","r7 - country1"],["img/фл-вьетнам.png","r7 - country2"],["img/фл-тайланд.png","r7 - country3"],["img/фл-индонезия.png","r7 - country4"],["img/фл-вьетнам.png","r7 - country5"],["img/фл-тайланд.png","r7 - country6"],["img/фл-индонезия.png","r7 - country7"],["img/фл-тайланд.png","r7 - country8"],["img/фл-вьетнам.png","r7 - country9"],["img/фл-индонезия.png","r7 - country10"]],region8:[["img/фл-индонезия.png","r8 - country1"],["img/фл-вьетнам.png","r8 - country2"],["img/фл-тайланд.png","r8 - country3"],["img/фл-индонезия.png","r8 - country4"],["img/фл-вьетнам.png","r8 - country5"],["img/фл-тайланд.png","r8 - country6"],["img/фл-индонезия.png","r8 - country7"],["img/фл-тайланд.png","r8 - country8"],["img/фл-вьетнам.png","r8 - country9"],["img/фл-индонезия.png","r8 - country10"]],region9:[["img/фл-индонезия.png","r9 - country1"],["img/фл-вьетнам.png","r9 - country2"],["img/фл-тайланд.png","r9 - country3"],["img/фл-индонезия.png","r9 - country4"],["img/фл-вьетнам.png","r9 - country5"],["img/фл-тайланд.png","r9 - country6"],["img/фл-индонезия.png","r9 - country7"],["img/фл-тайланд.png","r9 - country8"],["img/фл-вьетнам.png","r9 - country9"],["img/фл-индонезия.png","r9 - country10"]],region10:[["img/фл-индонезия.png","r10 - country1"],["img/фл-вьетнам.png","r10 - country2"],["img/фл-тайланд.png","r10 - country3"],["img/фл-индонезия.png","r10 - country4"],["img/фл-вьетнам.png","r10 - country5"],["img/фл-тайланд.png","r10 - country6"],["img/фл-индонезия.png","r10 - country7"],["img/фл-тайланд.png","r10 - country8"],["img/фл-вьетнам.png","r10 - country9"],["img/фл-индонезия.png","r10 - country10"]]};$(".selections").on("click",".button-ul-region .add-item",function(n){n.preventDefault();var t=$(n.target).closest(".region-country"),r=$(n.target).closest(".add-ul-button"),e=r.find("input");e.each(function(){var n=$(this);if(n.prop("checked")){n.closest(".button-ul-region").find(".add-region-country").addClass("button-disabled"),1==t.find(".wrap-buttons").length&&t.find(".wrap-buttons").hide(),r.hide();var e=n.val();$.get("new-region-country.html",function(n){var r=$(n);t.append(r),r.find(".wrap-ul-region-country h3").text(e);for(var o in i)o===e&&$.each(i[o],function(n,t){r.find(".button-ul-country ul").append("<li><label><img src="+t[0]+">"+t[1]+'<input type="checkbox" name="country" value=" '+t[1]+' "></label></li>')})}),n.removeAttr("checked"),n.parent().removeClass("icon-ok")}})}),$(".selections").on("click",".button-ul-country .add-item",function(n){n.preventDefault();var t=$(n.target).closest(".add-ul-button").find("input");t.each(function(){var t=$(this);if(t.prop("checked")){$(".add-ul-button").hide();var r=t.val(),e=t.prev("img").attr("src"),o='<li><img src="'+e+'"><input type="text" value="'+r+'" readonly><button type="button" class="icon-cancel"></button></li>',i=$(n.target).parents(".new-region-country").find("ul.country input"),a=!0;i.each(function(){var n=$(this).val();r===n&&(a=!1)}),a&&$(n.target).parents(".new-region-country").find("ul.country").append(o)}})});var a=$(".how-many-night");a.each(function(n){if(0===n){var t=$(this),r=t.find(".from-date").val(),e=t.find(".to-date").val();t.prev(".inp-how-many-night").val(r+" ― "+e+" ночей")}}),$(".selections").on("click",".how-many-night select",function(n){var t=$(n.target).closest(".how-many-night"),r=t.find(".from-date").val(),e=t.find(".to-date").val();parseInt(r)<parseInt(e)?t.prev(".inp-how-many-night").val(r+" ― "+e+" ночей"):t.prev(".inp-how-many-night").val("7 ― 14 ночей")}),$(".selections").on("click",".toggle-popup",function(n){$(n.target).next(".pop-up-filter").slideToggle(100),$(".toggle-popup").not(n.target).next(".pop-up-filter").hide()}),$(".how-many-people").each(function(n){if(0===n){var t=$(this),r=t.find(".adult").val(),e=t.find(".children").val();t.prev(".inp-how-many-people").val(r+" взрослых, "+e+" детей")}}),$(".selections").on("click",".how-many-people select",function(n){var t=$(n.target).closest(".how-many-people"),r=t.find(".adult").val(),e=t.find(".children").val();0===parseInt(e)?t.prev(".inp-how-many-people").val(r+" взрослых"):t.prev(".inp-how-many-people").val(r+" взрослых, "+e+" детей")}),$(".how-many-money").each(function(n){if(0===n){var t=$(this),r=t.find(".from-rub").val(),e=t.find(".to-rub").val();t.prev(".inp-how-many-money").val(r+" Р ― "+e+" Р")}}),$(".selections").on("click",".how-many-money select",function(n){var t=$(n.target).closest(".how-many-money"),r=t.find(".from-rub").val(),e=t.find(".to-rub").val();parseInt(r)<parseInt(e)?t.prev(".inp-how-many-money").val(r+" Р ― "+e+" Р"):t.prev(".inp-how-many-money").val("50 000 Р ― 150 000 Р")}),$(".selections").on("click",".block-star .icon-star",function(n){var t=$(n.target).children().val(),r=$(n.target).parent(".block-star").find("input");r.each(function(){var n=$(this).val();t>=n?$(this).parent(".icon-star").addClass("active-star"):$(this).parent(".icon-star").removeClass("active-star")})}),$(".how-many-rating").each(function(n){if(0===n){var t=$(this),r=t.find(".rating-select").val();t.prev(".block-rating").children(".inp-how-many-rating").val(r)}}),$(".selections").on("click",".how-many-rating select",function(n){var t=$(n.target).closest(".how-many-rating"),r=t.find(".rating-select").val();t.prev(".block-rating").children(".inp-how-many-rating").val(r)}),$(".type-food").each(function(n){if(0===n){var t=$(this),r=t.find(".select-type-food").val();t.prev(".inp-type-food").val(r)}}),$(".selections").on("click",".type-food select",function(n){var t=$(n.target).closest(".type-food"),r=t.find(".select-type-food").val();t.prev(".inp-type-food").val(r)}),$(".location-hotel").each(function(n){if(0===n){var t=$(this),r=t.find(".select-location-hotel").val();t.prev(".inp-location-hotel").val(r)}}),$(".selections").on("click",".location-hotel select",function(n){var t=$(n.target).closest(".location-hotel"),r=t.find(".select-location-hotel").val();t.prev(".inp-location-hotel").val(r)}),$(".selections").on("click",".del-selection",function(){var n=$(event.target).closest(".tab-pane"),t=n.attr("id"),r=$('.selections a[href="#'+t+'"]').parent("li");r.prev().length?r.prev().addClass("active"):r.next().addClass("active"),r.remove(),n.prev().length?n.prev().addClass("active"):n.next().addClass("active"),n.remove()})});